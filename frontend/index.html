<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üî•</text></svg>">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Civic Streak - Build Your Civic Habit</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
        }
        .container { max-width: 500px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 30px; }
        header h1 { font-size: 2.5rem; margin-bottom: 10px; }
        header p { opacity: 0.8; }
        .card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .wallet-section { text-align: center; }
        .wallet-btn {
            background: linear-gradient(135deg, #F78421, #E85D04);
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            color: #fff;
            transition: all 0.3s;
        }
        .wallet-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(247, 132, 33, 0.4); }
        .wallet-btn:disabled { background: #555; cursor: not-allowed; transform: none; box-shadow: none; }
        .wallet-info { margin-top: 15px; padding: 10px; background: rgba(46, 204, 113, 0.2); border-radius: 10px; display: none; }
        .wallet-info.show { display: block; }
        .streak-display { text-align: center; padding: 30px; }
        .streak-number {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, #f39c12, #e74c3c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .streak-label { font-size: 1.3rem; opacity: 0.8; margin-bottom: 20px; }
        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            color: #fff;
            transition: all 0.3s;
            width: 100%;
            margin-top: 15px;
        }
        .btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4); }
        .btn:disabled { background: #555; cursor: not-allowed; }
        .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 20px; }
        .stat-item { background: rgba(255,255,255,0.1); padding: 15px 10px; border-radius: 10px; text-align: center; }
        .stat-value { font-size: 1.3rem; font-weight: bold; color: #f39c12; }
        .stat-label { font-size: 0.75rem; opacity: 0.7; margin-top: 5px; }
        .progress-card { margin-top: 20px; }
        .progress-card h3 { margin-bottom: 15px; }
        .progress-bar-container { background: rgba(255,255,255,0.1); border-radius: 10px; height: 20px; overflow: hidden; }
        .progress-bar { background: linear-gradient(90deg, #667eea, #764ba2); height: 100%; width: 0%; transition: width 0.5s; }
        .progress-text { text-align: center; margin-top: 10px; opacity: 0.8; }
        .badges-card h3 { margin-bottom: 15px; }
        .badges-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .badge { background: rgba(255,255,255,0.05); padding: 15px 10px; border-radius: 10px; text-align: center; transition: all 0.3s; }
        .badge.earned { background: rgba(46, 204, 113, 0.2); border: 1px solid #2ecc71; }
        .badge-icon { font-size: 2rem; }
        .badge-name { font-size: 0.75rem; margin-top: 5px; }
        .badge-req { font-size: 0.65rem; opacity: 0.6; }
        .badge-status { margin-top: 8px; font-size: 1.2rem; }
        .message { padding: 15px; border-radius: 10px; margin-top: 15px; text-align: center; display: none; }
        .message.success { background: rgba(46, 204, 113, 0.2); border: 1px solid #2ecc71; }
        .message.error { background: rgba(231, 76, 60, 0.2); border: 1px solid #e74c3c; }
        .message.info { background: rgba(52, 152, 219, 0.2); border: 1px solid #3498db; }
        .message.show { display: block; }
        footer { text-align: center; margin-top: 30px; opacity: 0.6; font-size: 0.9rem; }
        .disclaimer { margin-top: 10px; font-size: 0.8rem; opacity: 0.5; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üî• Civic Streak</h1>
            <p>Build your civic engagement streak on Solana</p>
        </header>

        <div class="card wallet-section">
            <button id="connect-btn" class="wallet-btn" onclick="connectWallet()">üîó Connect Phantom Wallet</button>
            <div id="wallet-info" class="wallet-info">
                <span>‚úÖ Connected: </span><span id="wallet-address"></span>
            </div>
        </div>

        <div id="main-content" style="display: none;">
            <div class="card">
                <div class="streak-display">
                    <div class="streak-number" id="streak-count">0</div>
                    <div class="streak-label">Day Streak üî•</div>
                    <button id="claim-btn" class="btn" onclick="claimDaily()">üìÆ Mark Today's Civic Action</button>
                    <div id="message" class="message"></div>
                </div>
            </div>

            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="last-active">--</div>
                    <div class="stat-label">Last Active</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="civic-points">0</div>
                    <div class="stat-label">Points</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="badges-earned">0/3</div>
                    <div class="stat-label">Badges</div>
                </div>
            </div>

            <div class="card progress-card">
                <h3>Next Milestone</h3>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="progress-bar"></div>
                </div>
                <p class="progress-text" id="progress-text">0 / 7 days to first badge</p>
            </div>

            <div class="card badges-card">
                <h3>üéñÔ∏è Badge Collection</h3>
                <div class="badges-grid">
                    <div class="badge" id="badge-7">
                        <div class="badge-icon">üåü</div>
                        <div class="badge-name">Civic Starter</div>
                        <div class="badge-req">7 Days</div>
                        <div class="badge-status">üîí</div>
                    </div>
                    <div class="badge" id="badge-30">
                        <div class="badge-icon">üèÖ</div>
                        <div class="badge-name">Consistent</div>
                        <div class="badge-req">30 Days</div>
                        <div class="badge-status">üîí</div>
                    </div>
                    <div class="badge" id="badge-100">
                        <div class="badge-icon">üëë</div>
                        <div class="badge-name">Champion</div>
                        <div class="badge-req">100 Days</div>
                        <div class="badge-status">üîí</div>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>‚ö° Powered by Solana Blockchain</p>
            <p class="disclaimer">Streaks reset if you miss 48+ hours between actions</p>
        </footer>
    </div>

    <script>
        // Demo state
        let state = {
            connected: false,
            wallet: null,
            streak: 0,
            lastActive: null,
            points: 0,
            lastClaim: null
        };

        // Load from localStorage
        function loadState() {
            const saved = localStorage.getItem('civicStreak');
            if (saved) state = JSON.parse(saved);
        }

        // Save to localStorage
        function saveState() {
            localStorage.setItem('civicStreak', JSON.stringify(state));
        }

        // Connect wallet (demo)
        async function connectWallet() {
            state.connected = true;
            state.wallet = 'Demo' + Math.random().toString(36).substr(2, 8);
            if (state.streak === 0) {
                state.streak = 1;
                state.lastActive = new Date().toISOString();
                state.lastClaim = new Date().toISOString();
            }
            saveState();
            updateUI();
            showMessage('‚úÖ Wallet connected!', 'success');
        }

        // Claim daily
        function claimDaily() {
            if (!state.connected) {
                showMessage('Please connect wallet first!', 'error');
                return;
            }
            const now = new Date();
            if (state.lastClaim) {
                const hours = (now - new Date(state.lastClaim)) / (1000 * 60 * 60);
                if (hours < 24) {
                    showMessage(`‚è∞ Come back in ${Math.ceil(24 - hours)} hours!`, 'error');
                    return;
                }
            }
            if (state.lastActive) {
                const hours = (now - new Date(state.lastActive)) / (1000 * 60 * 60);
                if (hours > 48 && hours <= 72) {
                    state.streak = 1;
                    showMessage('üíî Streak broken! Starting fresh!', 'error');
                } else if (hours > 72) {
                    state.streak = 1;
                    showMessage('üíî Streak broken!', 'error');
                }
            }
            state.streak++;
            state.lastActive = now.toISOString();
            state.lastClaim = now.toISOString();
            state.points += Math.min(10 * state.streak, 100);
            saveState();
            updateUI();
            showMessage(`üî• Streak: ${state.streak} days! +${Math.min(10 * (state.streak-1), 100)} points!`, 'success');
        }

        // Update UI
        function updateUI() {
            document.getElementById('connect-btn').style.display = state.connected ? 'none' : 'block';
            document.getElementById('wallet-info').classList.toggle('show', state.connected);
            document.getElementById('wallet-address').textContent = state.connected ? state.wallet : '';
            document.getElementById('main-content').style.display = state.connected ? 'block' : 'none';
            document.getElementById('streak-count').textContent = state.streak;
            if (state.lastActive) {
                const d = new Date(state.lastActive);
                document.getElementById('last-active').textContent = d.toLocaleDateString();
            }
            document.getElementById('civic-points').textContent = state.points;
            const badges = [7, 30, 100].filter(m => state.streak >= m).length;
            document.getElementById('badges-earned').textContent = `${badges}/3`;
            [7, 30, 100].forEach(m => {
                const el = document.getElementById(`badge-${m}`);
                if (state.streak >= m) {
                    el.classList.add('earned');
                    el.querySelector('.badge-status').textContent = '‚úÖ';
                }
            });
            const next = state.streak < 7 ? 7 : state.streak < 30 ? 30 : state.streak < 100 ? 100 : 100;
            const progress = state.streak < next ? (state.streak / next) * 100 : 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;
            const daysLeft = next - state.streak;
            document.getElementById('progress-text').textContent = state.streak >= 100 ? 'üéâ All milestones reached!' : `${daysLeft} days to next badge`;
        }

        // Show message
        function showMessage(text, type) {
            const el = document.getElementById('message');
            el.textContent = text;
            el.className = `message ${type} show`;
            setTimeout(() => el.classList.remove('show'), 5000);
        }

        // Initialize
        loadState();
        updateUI();
    </script>
</body>
</html>
